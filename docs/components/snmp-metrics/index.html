<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=/snmpcollector.org/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/snmpcollector.org/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=/snmpcollector.org/main.bb749f5013a81b9f8f0ae300ebeac84d81825e31211e2ee03ac9ca077a4afae7bd9c497d50a4c5e3a39f59434c1f6590080497647d4a5f647f1e76f4ef0298e8.css integrity="sha512-u3SfUBOoG5+PCuMA6+rITYGCXjEhHi7gOsnKB3pK+ue9nEl9UKTF46OfWUNMH2WQCASXZH1KX2R/Hnb07wKY6A==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>SNMP Metrics - snmpcollector</title><meta name=description content="This component allows the user define core metrics to be collected from the device."><link rel=canonical href=/snmpcollector.org/docs/components/snmp-metrics/><meta name=twitter:card content="summary"><meta name=twitter:title content="SNMP Metrics"><meta name=twitter:description content="This component allows the user define core metrics to be collected from the device."><meta name=twitter:site content="@"><meta name=twitter:creator content="@"><meta property="og:title" content="SNMP Metrics"><meta property="og:description" content="This component allows the user define core metrics to be collected from the device."><meta property="og:type" content="article"><meta property="og:url" content="/snmpcollector.org/docs/components/snmp-metrics/"><meta property="article:published_time" content="2021-03-16T08:43:34+01:00"><meta property="article:modified_time" content="2021-03-16T08:43:34+01:00"><meta property="og:site_name" content="snmpcollector"><meta property="article:publisher" content="https://www.facebook.com/"><meta property="article:author" content="https://www.facebook.com/"><meta property="og:locale" content><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"\/snmpcollector.org"},{"@type":"ListItem","position":3,"name":"Docs","item":"\/snmpcollector.org\/docs\/"},{"@type":"ListItem","position":4,"name":"Components","item":"\/snmpcollector.org\/docs\/components\/"},{"@type":"ListItem","position":5,"name":"SNMP Metrics","item":"\/snmpcollector.org\/docs\/components\/snmp-metrics\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=/snmpcollector.org/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/snmpcollector.org/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/snmpcollector.org/favicon-16x16.png><link rel=manifest href=/snmpcollector.org/site.webmanifest></head><body class="docs single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 me-auto" href=/snmpcollector.org>snmpcollector</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/toni-moreno/snmpcollector><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ms-2 visually-hidden">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav me-auto order-5 order-md-2"><li class="nav-item active"><a class=nav-link href=/snmpcollector.org/docs/prologue/introduction/>Docs</a></li><li class=nav-item><a class=nav-link href=/snmpcollector.org/docs/prologue/introduction/>Download</a></li><li class=nav-item><a class=nav-link href=/snmpcollector.org/docs/prologue/introduction/>Community</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>Prologue</h3><ul class=list-unstyled><li><a class=docs-link href=/snmpcollector.org/docs/prologue/introduction/>Introduction</a></li><li><a class=docs-link href=/snmpcollector.org/docs/prologue/quick-start/>Quick Start</a></li><li><a class=docs-link href=/snmpcollector.org/docs/prologue/commands/>Commands</a></li></ul><h3>Components</h3><ul class=list-unstyled><li><a class=docs-link href=/snmpcollector.org/docs/components/variable-catalog/>Variable Catalog</a></li><li><a class=docs-link href=/snmpcollector.org/docs/components/influx-servers/>InfluxDB Servers</a></li><li><a class=docs-link href=/snmpcollector.org/docs/components/oid-conditions/>OID Conditions</a></li><li><a class="docs-link active" href=/snmpcollector.org/docs/components/snmp-metrics/>SNMP Metrics</a></li><li><a class=docs-link href=/snmpcollector.org/docs/components/measurements/>Measurements</a></li><li><a class=docs-link href=/snmpcollector.org/docs/components/measurement-groups/>Measurement Groups</a></li><li><a class=docs-link href=/snmpcollector.org/docs/components/measurement-filters/>Measurement Filters</a></li><li><a class=docs-link href=/snmpcollector.org/docs/components/custom-filters/>Custom filters</a></li><li><a class=docs-link href=/snmpcollector.org/docs/components/snmp-devices/>SNMP Devices</a></li></ul><h3>Runtime</h3><ul class=list-unstyled><li><a class=docs-link href=/snmpcollector.org/docs/runtime/runtime/>Runtime</a></li></ul><h3>Data Management</h3><h3>Troubleshooting</h3><h3>Examples</h3><h3>Public Templates DB</h3><h3>Contributions</h3><h3>Changelog</h3><h3>help</h3><ul class=list-unstyled><li><a class=docs-link href=/snmpcollector.org/docs/help/how-to-update/>How to Update</a></li><li><a class=docs-link href=/snmpcollector.org/docs/help/troubleshooting/>Troubleshooting</a></li><li><a class=docs-link href=/snmpcollector.org/docs/help/faq/>FAQ</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#view>View</a></li><li><a href=#addedit-snmp-metrics>Add/Edit SNMP Metrics</a><ul><li><a href=#configuration-parameters>Configuration Parameters</a></li><li><a href=#multi-edit-in-snmp-metrics>Multi edit in SNMP Metrics</a></li></ul></li><li><a href=#about-octetstringhex-string>About OCTETSTRING/Hex-String</a></li><li><a href=#about-bit-string-and-bit-string-check-metric-type>About BIT STRING and BIT STRING CHECK Metric Type</a></li><li><a href=#about-enum-metric-type>About ENUM Metric Type</a></li><li><a href=#about-multistringparser-metrics>About MULTISTRINGPARSER Metrics</a></li><li><a href=#about-stringeval-metrics>About STRINGEVAL Metrics</a><ul><li><a href=#usable-variables>Usable Variables</a></li><li><a href=#about-check>About Check</a></li></ul></li><li><a href=#examples>Examples</a><ul><li><a href=#acreating-new-stringeval-metric>A.Creating new StringEval Metric</a></li><li><a href=#b-creating-new-stringparser-metric>B. Creating new StringParser Metric</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>SNMP Metrics</h1><p class=lead>This component allows the user define core metrics to be collected from the device.</p><h2 id=view>View<a href=#view class=anchor aria-hidden=true>#</a></h2><p>Configured <strong>SNMP Metrics</strong> are shown as table. This will appear every time you navigate from menu.</p><figure class=post-figure><a href=/snmpcollector.org/docs/components/snmp-metrics/images/config_snmp_metrics_list.jpg><img src=/snmpcollector.org/docs/components/snmp-metrics/images/config_snmp_metrics_list_hub6549057966fefb9fed083126c7aa190_182033_600x400_fit_q75_box.jpg width=600 height=394 alt="SNMP Metric List"></a><figcaption>SNMP Metric List</figcaption></figure><h2 id=addedit-snmp-metrics>Add/Edit SNMP Metrics<a href=#addedit-snmp-metrics class=anchor aria-hidden=true>#</a></h2><ul><li><p><strong>Add</strong>: In the SNMP Metrics list click on new button <img src=/images/new_button.JPG alt="New Button"></p></li><li><p><strong>Edit</strong>: Click on SNMP Metric edit&rsquo;s button <img src=/images/edit_button.JPG alt="Edit Button"></p></li></ul><p>The Create/Modify form will show up:</p><figure class=post-figure><a href=/snmpcollector.org/docs/components/snmp-metrics/images/config_snmp_metrics_edit.jpg><img src=/snmpcollector.org/docs/components/snmp-metrics/images/config_snmp_metrics_edit_hu77b98c891206eb9264212256389120a5_57963_600x400_fit_q75_box.jpg width=387 height=400 alt="Create/Modify SNMP Metrics"></a><figcaption>Create/Modify SNMP Metrics</figcaption></figure><h3 id=configuration-parameters>Configuration Parameters<a href=#configuration-parameters class=anchor aria-hidden=true>#</a></h3><table><thead><tr><th>Type of settings</th><th>Config Parameter</th><th>Description</th></tr></thead><tbody><tr><td>Core settings</td><td>ID</td><td>Text String that uniquely identify the metric recommended use the MIB Name, should be unique in the database</td></tr><tr><td></td><td>FieldName</td><td>Set the &ldquo;field&rdquo; name inside a Influx measurement, could be the same of id or not, should be unique inside the measurement where the metric will be sent.</td></tr><tr><td>Metric settings</td><td>DataSrcType</td><td>Origin data type could be one of these:<br><ul><li>(SNMP SMI Type) INTEGER</li><li>(SNMP SMI Type) Integer32</li><li>(SNMP SMI Type) Gauge32</li><li>(SNMP SMI Type) UInteger32</li><li>(SNMP SMI Type) Unsigned32</li><li>(SNMP SMI Type) Counter32</li><li>(SNMP SMI Type) Counter64</li><li>(SNMP SMI Type) TimeTicks</li><li>(SNMP SMI Type) OCTETSTRING</li><li>(SNMP SMI Type) IpAddress</li><li>(Cooked type) TIMETICKS [Compute TimeTicks to seconds]</li><li>(SNMP SMI Type) BIT STRING (needs a named-number enumeration in extradata)</li><li>(Cooked type) COUNTER32 [Compute increments for 32 bit counters]</li><li>(Cooked type) COUNTER64 [Compute increments for 64 bit counters]</li><li>(Cooked type) COUNTERXX [Compute increments only if it really increments &ndash; as NON_NEGATIVE_DERIVATIVE does&ndash;]</li><li>(Cooked type) HWADDR [ Translate Hardware Address (MAC) from STRING]</li><li>(Cooked type) STRINGPARSER [ Compute values from Regex ]</li><li>(Cooked type) STRINGEVAL [evaluate data from other metrics]</li><li>(Cooked type) CONDITIONEVAL [evaluate OID table with boolean conditions and get number of true values]</li><li>(Cooked type) BIT STRING CHECK [needs the number bit to check in extradata , returns 1 or 0]</li><li>(Cooked type) ENUM - [needs named-number enumeration on extradata]</li><li>(Cooked type) MULTI-STRINGPARSER [generates multiple fields or tags from an snmp returned string and an Regular expression with multiple capturing groups]</li></ul></td></tr><tr><td></td><td>IsTag</td><td>If true data will be sent as a Influxdb &ldquo;TAG&rdquo;. (default is false)</td></tr><tr><td></td><td>BaseOID</td><td>Snmp OID for this metric ( could be the base OID when it belongs to a snmp indexed table), could not be set only if datasrctype is of type &ldquo;String Eval&rdquo;.</td></tr><tr><td></td><td>ExtraData</td><td>data needed to special data types as String Eval(evaluated expression needed), String Parser(regex needed) or OctetString to add a trim function (0.8.2+)</td></tr><tr><td></td><td>GetRate</td><td>Only useful on COUNTER64/32/XX types , if true value sent will be the computed difference and after divided by the number of elapsed seconds between snmp calls</td></tr><tr><td></td><td>Conversion</td><td>before 0.8.0 version all data was sent as FLOAT64 numbers, from new 0.8.0 version could select output format depending on the DataSrcType, usually FLOAT ( float64 ) , INTEGER (int64) , BOOLEAN or STRING. Not all conversions all available on all input datasources. Unsigned Integer conversion not supported yet.</td></tr><tr><td>Metric autoscale</td><td>Scale</td><td>if set (as a floating point value) computed data will be scaled before sent.</td></tr><tr><td></td><td>Shift</td><td>if set (as a floating point value) computed data will be shifted before sent.</td></tr><tr><td>Extra settings</td><td>Description</td><td>any useful discretion to understand data gathered for this metric ( recommended place here units of the measurement).</td></tr></tbody></table><p><em><strong>Notes</strong></em>:
The SnmpCollector Metric engine computes all its data and sent them as floating point values to the database, except for tags that will be sent as text strings</p><h3 id=multi-edit-in-snmp-metrics>Multi edit in SNMP Metrics<a href=#multi-edit-in-snmp-metrics class=anchor aria-hidden=true>#</a></h3><p>Multi edit has 2 options: Remove and Change property</p><ol><li><p>Remove: Allows to remove all the selected items</p></li><li><p>Change property: Allows to change the selected property of all the selected items. The properties are the same defined in the configuration.</p></li></ol><table><thead><tr><th>Property</th><th>Type</th><th>Options/Values</th></tr></thead><tbody><tr><td>DataSrcType</td><td>Selector</td><td><li>Int,Int32,Gauge32,UInt32,Unsigned32,Counter32,Counter64</li><li>TimeTicks, OCTETSTRING, IpAddress</li><li>COUNTER32, COUNTER64, COUNTERXX</li><li>HWADDR, STRINGPARSER,STRINGEVAL, CONDITIONEVAL</li></ul></td></tr><tr><td>Scale</td><td>Input</td><td>Any number</td></tr><tr><td>Shift</td><td>Input</td><td>Any number</td></tr><tr><td>IsTag</td><td>Selector</td><td>True / False</td></tr><tr><td><img width=50/></td><td><img width=50/></td><td><img width=50/></td></tr></tbody></table><h2 id=about-octetstringhex-string>About OCTETSTRING/Hex-String<a href=#about-octetstringhex-string class=anchor aria-hidden=true>#</a></h2><p>From 0.8.0 version, you could use OCTETSTRING as datasource Types for Integers codified as Hex-String, in this case you should enable conversion to INTEGER.</p><blockquote><p>If updated from release &lt; 0.8.0 to release >= 0.8.0 version you should do a manual upgrade of your database `update snmp_metric_cfg set Conversion=3 where datasrctype=&lsquo;OCTETSTRING&rsquo;; if not done any OCTETSTRING data won&rsquo;t be collected.</p></blockquote><p>From 0.8.2 version, it is possible to apply trim functions on octet-string metric based on <code>ExtraData</code></p><p>Available options:</p><ul><li>trimright(&lsquo;xyz&rsquo;): removes trailing characters defined by &lsquo;xyz&rsquo;</li><li>trimleft(&lsquo;xyz&rsquo;): removes leading characters defined by &lsquo;xyz&rsquo;</li><li>trim(&lsquo;xyz&rsquo;): removes trailing and leading characters defined by &lsquo;xyz&rsquo;</li><li>trimspace : remove all leading and trailing tabs, whitespaces, newlines and return carriage this is (\t \n\r)</li></ul><p>Example:</p><pre><code>OID &gt; .1.2.3.4.5

.1.2.3.4.5.1 = &quot;   Test string with blank spaces   &quot;

ExtraData: trimspace

Output:
.1.2.3.4.5.1 = &quot;Test string with blank spaces&quot;
</code></pre><h2 id=about-bit-string-and-bit-string-check-metric-type>About BIT STRING and BIT STRING CHECK Metric Type<a href=#about-bit-string-and-bit-string-check-metric-type class=anchor aria-hidden=true>#</a></h2><p>From 0.7.2 version , there is the way to get data from BIT STRING OID&rsquo;s. BITS is a pseudo data type that specifies a collection of labelled bits as explained here !(https://www.webnms.com/snmp/help/snmpapi/snmpv3/using_mibs_in_applns/bits_datatype.html)</p><p>If you want config a BIT STRING you should also provide the bit->label comma separated array, in the ExtraData Field.</p><p>By example:<code>sunday(0), monday(1), tuesday(2), wednesday(3), thursday(4), friday(5), saturday(6)</code></p><p>if data got on the snmpquery is this bitstring , The output will be an concatenated labeled array sent as and string to the influxDB.
Examples:</p><table><thead><tr><th>Snmp query Out</th><th>value sent</th></tr></thead><tbody><tr><td>&lsquo;011001B&rsquo;</td><td>&ldquo;monday,tuesday,saturday&rdquo;</td></tr><tr><td>&lsquo;100001B&rsquo;</td><td>&ldquo;sunday,saturday&rdquo;</td></tr><tr><td>&lsquo;010000B&rsquo;</td><td>&ldquo;monday&rdquo;</td></tr><tr><td>&lsquo;01B&rsquo;</td><td>&ldquo;monday&rdquo;</td></tr></tbody></table><p>If we would like to know only if certain bit has been check we can use the Cooked Type BIT STRING CHECK &ldquo;BITSCHECK&rdquo;. Suppose you can get with a BIT STRING the state of one device and the bit,label map is</p><table><thead><tr><th>bit number</th><th>label</th></tr></thead><tbody><tr><td>0</td><td>up</td></tr><tr><td>1</td><td>down</td></tr><tr><td>2</td><td>restoring</td></tr><tr><td>3</td><td>failed</td></tr></tbody></table><p>You can check if the device is ok by only check that the byte &ldquo;0&rdquo; is set ( the device will be up) , in this case the metric will send 1 floating point number if the selected byte is set or 0 if not.</p><h2 id=about-enum-metric-type>About ENUM Metric Type<a href=#about-enum-metric-type class=anchor aria-hidden=true>#</a></h2><p>From 0.7.7 version , there is the way to map enum
values and send it to InfluxDB as STRING (as Tag or Field). The enum-named values can be defined on the ExtraData field with the following syntax:
<code>&lt;CUSTOM_DESCRIPTION>(&lt;ENUM>)</code></p><p>If a returned value by the OID query is not mapped on the extradata, the value will be sent directly as a STRING.</p><p>By example, the following OID query <code>ifType OID - 1.3.6.1.2.1.2.2.1.3</code> would return the type of interfaces. The ENUM metric Type would allow the user to map those results and add custom text to clarify its meaning:</p><p>With the following Metric:</p><pre><code>SNMP possible results: 6,24,135

Base OID : 1.3.6.1.2.1.2.2.1.3
ExtraData: EthernetLike interfaces (6), SubInterfaces L2VLAN (135)
</code></pre><p>Would generate the following output to InfluxDB:</p><table><thead><tr><th>Snmp query Out</th><th>ExtraData</th><th>value sent</th></tr></thead><tbody><tr><td>6</td><td>EthernetLike interfaces (6)</td><td>&ldquo;EthernetLike interfaces (6)&rdquo;</td></tr><tr><td>24</td><td>(non mapped)</td><td>&ldquo;24&rdquo;</td></tr><tr><td>135</td><td>SubInterfaces L2VLAN (135)</td><td>&ldquo;SubInterfaces L2VLAN (135)&rdquo;</td></tr></tbody></table><h2 id=about-multistringparser-metrics>About MULTISTRINGPARSER Metrics<a href=#about-multistringparser-metrics class=anchor aria-hidden=true>#</a></h2><p>From 0.7.6 version , there is a new metric type and the first capable to generate more than one field/tag with only one metric definition.
Will parse data with regex with capturing groups and each capture group will be attached to a definition ITEM, each definition ITEM will generate a Field or a Tag. We assume that the origin got data from devices are readable strings.</p><p>Configuration will be placed in:</p><ul><li><strong>FieldName:</strong> Comma separated value of ITEM definitions</li><li><strong>ExtraData:</strong> Regular expression with multiple capturing groups</li></ul><p>by example:</p><ul><li><strong>FieldName:</strong> <code>F|field_name_1|CONV1,F|field_name_2|CONV2,T|tag_name1|CONV3</code></li><li><strong>ExtraData:</strong> <code>'([^;]*);([^;]*);([^;]*);' &lt;-regexp</code></li></ul><p>Is necessary configure as many ITEMS as capturing groups.</p><p>Each ITEM in the FieldName needs for 3 parameters before to be sent.</p><p><code>TYPE|NAME|CONVERSION</code></p><table><thead><tr><th>configuration</th><th>what means</th></tr></thead><tbody><tr><td>TYPE</td><td>F = Field , T = Tag ( this parameter invalidates the use of isTag flag in the metric definition)</td></tr><tr><td>NAME</td><td>Field/Tag Name will be sent to the InfluxDB</td></tr><tr><td>CONVERSION</td><td>how should evaluate the returned string? possible values (STR,INT,FP,BL)</td></tr></tbody></table><p>Fields/Tag definitions will be evaluated as:</p><table><thead><tr><th>CONVERSORS</th><th>Conversion type (from String)</th></tr></thead><tbody><tr><td>STR</td><td>to maintain as string ( no conversion will be done)</td></tr><tr><td>INT</td><td>to convert as and 64bits integer</td></tr><tr><td>FP</td><td>to convert as and 64 bits floating point</td></tr><tr><td>BL</td><td>to convert as a boolean</td></tr></tbody></table><h2 id=about-stringeval-metrics>About STRINGEVAL Metrics<a href=#about-stringeval-metrics class=anchor aria-hidden=true>#</a></h2><p>The StringEval Metric type let us compute any value from an &ldquo;expression evaluation&rdquo; , the expression could be mathematical or logical. Available documentation on what kind of evaluations could snmpcollector do could be read here <a href=https://github.com/Knetic/govaluate/blob/master/MANUAL.md>EXPRESSION TUTORIAL</a></p><p><strong>Important defining <code>FieldNames</code> that contains characters like [0-9], [-], or something else, needs to be escaped using brackets on the formula. Example: [1m_ifHCInOctets] * [ifHighSpeed]</strong></p><h3 id=usable-variables>Usable Variables<a href=#usable-variables class=anchor aria-hidden=true>#</a></h3><p>What variables could I use on my expressions?, Here the variables</p><table><thead><tr><th>Variable</th><th>Description</th></tr></thead><tbody><tr><td>FieldNames</td><td>Any of the fieldNames placed on the same measurement</td></tr><tr><td>NF</td><td>especial variable that could be used to get the &ldquo;number of fields&rdquo; in the measurement (as in AWK)</td></tr><tr><td>NR</td><td>especial variable that could be used to get the &ldquo;number of rows&rdquo; in the measurement (after all filters has been applied), on scalar/value measurements, NR will be always 1 . On tabular/Indexed measurements NR will be the current number of rows (after filters applied)</td></tr><tr><td>NFR(>0.7.6)</td><td>especial variable that could be used to get the"non filtered rows", that counts the &ldquo;number of rows&rdquo; as the below NR but before all filters has been applied.</td></tr><tr><td>Catalog Vars( > 0.7.5)</td><td>Any of the defined variables in the catalog</td></tr></tbody></table><h3 id=about-check>About Check<a href=#about-check class=anchor aria-hidden=true>#</a></h3><p>When defining a new STRINGEVAL metric, the formula in extra data is stored on the configuration database but not evaluated yet since it needs to be placed into a measurement to check if expression its ok (validating all variables used in the expression are in the before table</p><h2 id=examples>Examples<a href=#examples class=anchor aria-hidden=true>#</a></h2><h3 id=acreating-new-stringeval-metric>A.Creating new StringEval Metric<a href=#acreating-new-stringeval-metric class=anchor aria-hidden=true>#</a></h3><p>Let&rsquo;s create a SNMP Metric that computes the <code>TotalOctets</code> on each port. The formula follows as:</p><pre><code>TotalOctets = (InBytes + OutBytes)
</code></pre><h4 id=a1-add-needed-metrics-to-get-our-new-string-eval-metric>A.1 Add needed metrics to get our new string eval metric:<a href=#a1-add-needed-metrics-to-get-our-new-string-eval-metric class=anchor aria-hidden=true>#</a></h4><table><thead><tr><th>ID</th><th>FieldName</th><th>BaseOID</th><th>DataSrcType</th><th>ExtraData</th><th>GetRate</th><th>Scale</th><th>Shift</th><th>IsTag</th></tr></thead><tbody><tr><td>ifHCInOctets</td><td>InBytes</td><td>.1.3.6.1.2.1.31.1.1.1.6</td><td>COUNTER64</td><td></td><td>false</td><td>0</td><td>0</td><td>false</td></tr><tr><td>ifHCOutOctets</td><td>OutBytes</td><td>.1.3.6.1.2.1.31.1.1.1.10</td><td>COUNTER64</td><td></td><td>false</td><td>0</td><td>0</td><td>false</td></tr><tr><td><img width=25/></td><td><img width=50/></td><td><img width=50/></td><td><img width=50/></td><td><img width=50/></td><td><img width=50/></td><td></td><td></td><td></td></tr></tbody></table><h4 id=a2-add-totaloctets-metric>A.2 Add <code>TotalOctets</code> metric:<a href=#a2-add-totaloctets-metric class=anchor aria-hidden=true>#</a></h4><table><thead><tr><th>ID</th><th>FieldName</th><th>BaseOID</th><th>DataSrcType</th><th>ExtraData</th><th>GetRate</th><th>Scale</th><th>Shift</th><th>IsTag</th></tr></thead><tbody><tr><td>TotalOctets</td><td>TotalOctets</td><td></td><td>STRINGEVAL</td><td>ifHCInOctets + ifHCOutOctets</td><td></td><td>0</td><td>0</td><td>false</td></tr></tbody></table><h4 id=a3-result>A.3 Result<a href=#a3-result class=anchor aria-hidden=true>#</a></h4><p>The SNMP Metric list must be like:</p><table><thead><tr><th>ID</th><th>FieldName</th><th>BaseOID</th><th>DataSrcType</th><th>ExtraData</th><th>GetRate</th><th>Scale</th><th>Shift</th><th>IsTag</th></tr></thead><tbody><tr><td>ifHCInOctets</td><td>InBytes</td><td>.1.3.6.1.2.1.31.1.1.1.6</td><td>COUNTER64</td><td></td><td>false</td><td>0</td><td>0</td><td>false</td></tr><tr><td>ifHCOutOctets</td><td>OutBytes</td><td>.1.3.6.1.2.1.31.1.1.1.10</td><td>COUNTER64</td><td></td><td>false</td><td>0</td><td>0</td><td>false</td></tr><tr><td>TotalOctets</td><td>TotalOctets</td><td></td><td>STRINGEVAL</td><td>InBytes + OutBytes</td><td></td><td>0</td><td>0</td><td>false</td></tr></tbody></table><h3 id=b-creating-new-stringparser-metric>B. Creating new StringParser Metric<a href=#b-creating-new-stringparser-metric class=anchor aria-hidden=true>#</a></h3><p>Some OIDs results are full strings that contains on some part of its texts the value that we wants to capture.
In this example we will work with an Infoblox device and the following OID that gives us Fan1 RPM: <code>.1.3.6.1.4.1.7779.3.1.1.2.1.10.1.3.28</code>, with an output as: <code>FAN 1: 8725 RPM</code></p><h4 id=b1-define-the-regex-that-would-capture-the-group>B.1 Define the regex that would capture the group:<a href=#b1-define-the-regex-that-would-capture-the-group class=anchor aria-hidden=true>#</a></h4><p>We need to capture the RPM speed, so we define the capture group as: <code>.*: *([0-9]*)* *RPM</code></p><h4 id=b2-add-new-stringparser-metric>B.2 Add new StringParser metric<a href=#b2-add-new-stringparser-metric class=anchor aria-hidden=true>#</a></h4><table><thead><tr><th>ID</th><th>FieldName</th><th>BaseOID</th><th>DataSrcType</th><th>ExtraData</th><th>GetRate</th><th>Scale</th><th>Shift</th><th>IsTag</th></tr></thead><tbody><tr><td>Infoblox_FanState1</td><td>fanState1</td><td></td><td>STRINGPARSER</td><td><code>.*: *([0-9]*)* *RPM</code></td><td></td><td>0</td><td>0</td><td>false</td></tr></tbody></table><div class="docs-navigation d-flex justify-content-between"><a href=/snmpcollector.org/docs/components/oid-conditions/><div class="card my-1"><div class="card-body py-2">&larr; OID Conditions</div></div></a><a class=ms-auto href=/snmpcollector.org/docs/components/measurements/><div class="card my-1"><div class="card-body py-2">Measurements &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://gohugo.io/>Hugo</a>, and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=/snmpcollector.org/js/highlight.min.5c9528a6a1c07a12ee5032cb94e4c7bef72740593cde4b26300995d7e94526b35ea2b5b6981f7ac317032690ad6c5318f3ff17d6117f383c0346b3cd7a7771a2.js integrity="sha512-XJUopqHAehLuUDLLlOTHvvcnQFk83ksmMAmV1+lFJrNeorW2mB96wxcDJpCtbFMY8/8X1hF/ODwDRrPNendxog==" crossorigin=anonymous defer></script><script src=/snmpcollector.org/main.min.398009e84eec0d0056c796393dd59c0fc1256540b3c6ebcd70d26840a1b2691113affd7d2d9d9e37aa22e3877e8a95b26b19dcd28341036f26390ee91ded7d25.js integrity="sha512-OYAJ6E7sDQBWx5Y5PdWcD8ElZUCzxuvNcNJoQKGyaRETr/19LZ2eN6oi44d+ipWyaxnc0oNBA28mOQ7pHe19JQ==" crossorigin=anonymous defer></script><script src=/snmpcollector.org/index.min.4e7011ef3e5e8bf97783a553297ce457442f96f7e146c94420500ada4c5fef7571077ce0633570e72bb7ce61c12d4ad992afca5056e609f4350b581cd634eff2.js integrity="sha512-TnAR7z5ei/l3g6VTKXzkV0QvlvfhRslEIFAK2kxf73VxB3zgYzVw5yu3zmHBLUrZkq/KUFbmCfQ1C1gc1jTv8g==" crossorigin=anonymous defer></script></body></html>